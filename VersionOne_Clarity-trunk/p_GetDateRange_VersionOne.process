{"script_libraries":[],"maxThreads":1,"annotations":[],"externalDatasets":[],"ui":{"paletteX":31,"paletteY":257,"dividerY":401},"links":[{"data":"332.5,91 380,91","target":"Query - Min date","source":"Setup REST Min call","decision":""},{"data":"1120.5,91 1199,91","target":"Stop","source":"Parse Max date","decision":""},{"data":"647.5,91 692.5,91","target":"Setup REST Max call","source":"Parse Min date","decision":""},{"data":"160,91 219.5,91","target":"Setup REST Min call","source":"Start","decision":""},{"data":"496,91 542.5,91","target":"Parse Min date","source":"Query - Min date","decision":""},{"data":"809.5,91 859.5,91","target":"Query - Max date","source":"Setup REST Max call","decision":""},{"data":"954.5,91 1011.5,91","target":"Parse Max date","source":"Query - Max date","decision":""}],"steps":[{"x":1012,"y":50,"script":"","type":"Script","name":"Parse Max date","expression":"Dim outMsg as DJMessage\r\rSet outMsg = FindMessage(\"outMsg\")\r\r'Parse the date out of the REST response\rmaxDate = Parse(1, Parse(2, outMsg.Body, \"<Attribute name=\"\"Date\"\">\"), \"</Attribute>\")\rDefineMacro(\"MaxActualDate\", maxDate)\r\rLogMessage(\"info\", \">>>>> Maximum Actual date: \" & MacroValue(\"MaxActualDate\"))","ignoreError":false,"enabled":true,"description":""},{"x":543,"y":50,"script":"","type":"Script","name":"Parse Min date","expression":"Dim outMsg as DJMessage\r\rSet outMsg = FindMessage(\"outMsg\")\r\r'Parse the date out of the REST response\rminDate = Parse(1, Parse(2, outMsg.Body, \"<Attribute name=\"\"Date\"\">\"), \"</Attribute>\")\rIf Len(Trim(minDate)) > 0 Then\r\tDefineMacro(\"MinActualDate\", DateAdd(\"d\", -7, DateValue(minDate)))\rElse\r\tDefineMacro(\"MinActualDate\", \"\")\rEnd If\r\rLogMessage(\"info\", \">>>>> Minimum Actual date: \" & minDate)","ignoreError":false,"enabled":true,"description":""},{"x":860,"y":50,"component":"VersionOne REST Invoker - Actuals","type":"Invoker","name":"Query - Max date","options":[{"name":"httpMethod","value":"GET"},{"name":"urlQueryString","value":"sel=Date&where=ChangeDateUTC%3E'$(QueryDate)'&sort=-Date&page=1,0"},{"name":"soapAction","value":""},{"name":"retryCount","value":"5"},{"name":"timeout","value":"30"},{"name":"logHeaders","value":"true"},{"name":"responseFile","value":""}],"ignoreError":false,"enabled":true,"action":"Execute","parameters":[{"position":0,"name":"SourceMessage","value":"inMsg"},{"position":1,"name":"TargetMessage","value":"outMsg"}],"description":""},{"x":380,"y":50,"component":"VersionOne REST Invoker - Actuals","type":"Invoker","name":"Query - Min date","options":[{"name":"httpMethod","value":"GET"},{"name":"urlQueryString","value":"sel=Date&where=ChangeDateUTC%3E'$(QueryDate)'&sort=Date&page=1,0"},{"name":"soapAction","value":""},{"name":"retryCount","value":"5"},{"name":"timeout","value":"30"},{"name":"logHeaders","value":"true"},{"name":"responseFile","value":""}],"ignoreError":false,"enabled":true,"action":"Execute","parameters":[{"position":0,"name":"SourceMessage","value":"inMsg"},{"position":1,"name":"TargetMessage","value":"outMsg"}],"description":""},{"x":693,"y":50,"script":"","type":"Script","name":"Setup REST Max call","expression":"'Setup Rest Invoker to call VersionOne Actual module for max date of Actuals that have been added or changed since the data supplied.","ignoreError":false,"enabled":true,"description":""},{"x":220,"y":50,"script":"","type":"Script","name":"Setup REST Min call","expression":"'Setup Rest Invoker to call VersionOne Actual module for min date of Actuals that have been added or changed since the data supplied.\r\r' NEED TO SET QUERY DATE MACRO?\r","ignoreError":false,"enabled":true,"description":""},{"x":100,"y":50,"script":"","type":"Start","name":"Start","expression":"Dim inMsg as DJMessage\rDim outMsg as DJMessage\r\rSet inMsg = new DJMessage \"inMsg\"\rSet outMsg = new DJMessage \"outMsg\"","ignoreError":false,"enabled":true,"description":""},{"x":1199,"y":50,"script":"","type":"Stop","name":"Stop","expression":"Set inMsg = nothing\rSet outMsg = nothing\r","ignoreError":false,"enabled":true,"description":""}],"variables":[],"components":[{"type":"REST Invoker 1.0.0","name":"VersionOne REST Invoker - Actuals","options":[{"name":"protocol","value":"HTTP","displayvalue":"HTTP","editable":true,"hidden":false,"description":null,"displayname":"Protocol"},{"name":"url","value":"$(VersionOne_endpoint)Actual","displayvalue":"$(VersionOne_endpoint)Actual","editable":true,"hidden":false,"description":null,"displayname":"URL"},{"name":"sendUrlData","value":"URL","displayvalue":"URL","editable":true,"hidden":false,"description":null,"displayname":"Send Source Via"},{"name":"globalEncoding","value":"UTF-8","displayvalue":"UTF-8","editable":true,"hidden":false,"description":null,"displayname":"Message Encoding"},{"name":"contentType","value":"text/xml; charset=UTF-8","displayvalue":"text/xml; charset=UTF-8","editable":true,"hidden":false,"description":null,"displayname":"Content Type"},{"name":"httpUsername","value":"$(VersionOne_username)","displayvalue":"$(VersionOne_username)","editable":true,"hidden":false,"description":null,"displayname":"HTTP Username"},{"name":"httpPassword","value":"$(VersionOne_password)","displayvalue":"$(VersionOne_password)","editable":true,"hidden":false,"description":null,"displayname":"HTTP Password"},{"name":"userDomain","value":"","displayvalue":"","editable":true,"hidden":false,"description":null,"displayname":"Domain (NTLM Only)"},{"name":"proxyServer","value":"","displayvalue":"","editable":true,"hidden":false,"description":null,"displayname":"Proxy Server"},{"name":"proxyPort","value":"","displayvalue":"","editable":true,"hidden":false,"description":null,"displayname":"Proxy Port"},{"name":"proxyUser","value":"","displayvalue":"","editable":true,"hidden":false,"description":null,"displayname":"Proxy Username"},{"name":"proxyPswd","value":"","displayvalue":"","editable":true,"hidden":false,"description":null,"displayname":"Proxy Password"}],"globalTransaction":false,"componentType":"Invoker"}],"sessions":[],"externalSessions":[],"breakOnFirstError":true}