{"externalSessions":[],"breakOnFirstError":true,"script_libraries":[],"annotations":[],"variables":[{"type":"DJRowSet","array":false,"initialValue":"","name":"Clarity_TimePeriod_rowset","dims":[],"is_public":true,"description":""},{"type":"Variant","array":false,"initialValue":"0","name":"actualsMerged","dims":[],"is_public":true,"description":"This is a flag to indicate whether or not the incoming actuals have been merged with the existing ones.  If none have been merged then there is nothing to write to Clarity PPM."},{"type":"DJRowSet","array":false,"initialValue":"","name":"VersionOne_Actuals_rowset","dims":[],"is_public":true,"description":""}],"sessions":[],"externalDatasets":[],"ui":{"paletteX":60,"paletteY":414.25,"dividerY":589},"links":[{"data":"1588,273 1498,363","target":"Stop","source":"Write to Clarity","decision":""},{"data":"69,91 120,91","target":"Read QueryDate","source":"Start","decision":""},{"data":"540,91 583.5,91","target":"Found new Actuals?","source":"Get V1 date range","decision":""},{"data":"234,91 279,91","target":"QueryDate read?","source":"Read QueryDate","decision":""},{"data":"395,91 448,91","target":"Get V1 date range","source":"QueryDate read?","decision":"True"},{"data":"342,126 342,349","target":"Log error msg","source":"QueryDate read?","decision":"False"},{"data":"387,394 1431,394","target":"Stop","source":"Log error msg","decision":""},{"data":"668.5,91 747,90","target":"Create V1 lookup table","source":"Found new Actuals?","decision":"True"},{"data":"1465,125 1466,201","target":"Write to log","source":"Actuals merged?","decision":"False"},{"data":"1466,280 1466,349","target":"Stop","source":"Write to log","decision":""},{"data":"838,90 902,90","target":"Read V1 Actuals","source":"Create V1 lookup table","decision":""},{"data":"1014,90 1085,90","target":"Read Clarity TimePeriods","source":"Read V1 Actuals","decision":""},{"data":"1179,90 1258,90","target":"Insert new Actuals","source":"Read Clarity TimePeriods","decision":""},{"data":"1342,90 1403,90","target":"Actuals merged?","source":"Insert new Actuals","decision":""},{"data":"1501,125 1578,197","target":"Write to Clarity","source":"Actuals merged?","decision":"True"},{"data":"668.5,105 971,219","target":"Log error","source":"Found new Actuals?","decision":"False"},{"data":"1042,244 1432,383","target":"Stop","source":"Log error","decision":""}],"steps":[{"x":1403,"y":49,"type":"Decision","ignoreError":false,"name":"Actuals merged?","expression":"actualsMerged == 1","enabled":true,"description":"This decision step determines whether or not the incoming actuals were matched to the correct TimeSheet and should be inserted.  If none were matched, there is nothing to be written to Clarity."},{"x":746,"y":49,"type":"Process","ignoreError":false,"process":"p_reconcile_resources","name":"Create V1 lookup table","enabled":true,"datasets":[],"sessions":[],"description":""},{"x":584,"y":50,"type":"Decision","ignoreError":false,"name":"Found new Actuals?","expression":"Len(Trim(MacroValue(\"MinActualDate\"))) > 0 And Len(Trim(MacroValue(\"MaxActualDate\"))) > 0","enabled":true,"description":"Decision step will return True if any Actuals have been created/updated since the last time the integration ran.  If there are no new Actuals to be integrated, then the process is finished."},{"x":448,"y":50,"type":"Process","ignoreError":false,"process":"p_GetDateRange_VersionOne","name":"Get V1 date range","enabled":true,"datasets":[],"sessions":[],"description":""},{"x":1258,"y":49,"type":"Transformation","sourceDatasets":[{"name":"SOURCE","dataset_rref":"m_insert_new_Actuals_src_ds"}],"ignoreError":false,"lookupDatasets":[],"name":"Insert new Actuals","enabled":true,"targetDatasets":[{"name":"TARGET_1","dataset_rref":"m_insert_new_Actuals_trg_ds"}],"description":"","map":"m_insert_new_Actuals"},{"x":970,"y":192,"type":"Script","ignoreError":false,"name":"Log error","expression":"LogMessage(\"info\", \">>>>> No new actuals were found.\")","enabled":true,"script":"","description":""},{"x":287,"y":353,"type":"Script","ignoreError":false,"name":"Log error msg","expression":"LogMessage(\"error\", \">>>>> ERROR: QueryDate not found.  Either the file does not exist, or the date was not written to the file correctly on the last execution.\")","enabled":true,"script":"","description":""},{"x":279,"y":50,"type":"Decision","ignoreError":false,"name":"QueryDate read?","expression":"MacroValue(\"QueryDate\") <> \"\"","enabled":true,"description":""},{"x":1085,"y":49,"type":"Transformation","sourceDatasets":[{"name":"SOURCE","dataset_rref":"m_read_Clarity_TimePeriods_src_ds"}],"ignoreError":false,"lookupDatasets":[],"name":"Read Clarity TimePeriods","enabled":true,"targetDatasets":[{"name":"TARGET_1","dataset_rref":"m_read_Clarity_TimePeriods_trg_ds"}],"description":"","map":"m_read_Clarity_TimePeriods"},{"x":120,"y":50,"type":"Script","ignoreError":false,"name":"Read QueryDate","expression":"filename = MacroValue(\"DATA\") & \"VersionOne_Clarity_lastRunDate.txt\"\r\rIf FileExists(filename) Then\r\ttemp = FileRead(filename)\r\tDefineMacro(\"QueryDate\", temp)\rElse\r\tDefineMacro(\"QueryDate\", \"\")\rEnd If\r\rLogMessage(\"info\", \">>>>> Incoming query date read from file: \" & MacroValue(\"QueryDate\"))","enabled":true,"script":"","description":"Grabs the value for the QueryDate macro from a local file."},{"x":902,"y":49,"type":"Process","ignoreError":false,"process":"p_read_VersionOne_Actuals","name":"Read V1 Actuals","enabled":true,"datasets":[],"sessions":[],"description":""},{"x":9,"y":50,"type":"Start","ignoreError":false,"name":"Start","expression":"","enabled":true,"script":"","description":""},{"x":1431,"y":353,"type":"Stop","ignoreError":false,"name":"Stop","expression":"ILClear(\"Clarity_resourceIDs\")\r\rSet VersionOne_Actuals_rowset = nothing\r","enabled":true,"script":"","description":""},{"x":1565,"y":197,"type":"Transformation","sourceDatasets":[{"name":"SOURCE","dataset_rref":"m_write_TimePeriods_to_Clarity_src_ds"}],"ignoreError":false,"lookupDatasets":[],"name":"Write to Clarity","enabled":true,"targetDatasets":[{"name":"TARGET_1","dataset_rref":"m_write_TimePeriods_to_Clarity_trg_ds"}],"description":"","map":"m_write_TimePeriods_to_Clarity"},{"x":1418,"y":204,"type":"Script","ignoreError":false,"name":"Write to log","expression":"LogMessage(\"info\", \">>>>> Unable to map any incoming actuals to Clarity PPM TimeSheets.  Nothing will be written to Clarity PPM.\")","enabled":true,"script":"","description":""}],"components":[],"maxThreads":1}