{"externalDatasets":[],"components":[],"annotations":[],"sessions":[],"externalSessions":[],"breakOnFirstError":true,"script_libraries":[],"links":[{"source":"Start","target":"Read QueryDate","decision":"","data":"69,91 111,91"},{"source":"Get V1 date range","target":"Found new Actuals?","decision":"","data":"534,91 577.5,91"},{"source":"Read QueryDate","target":"QueryDate read?","decision":"","data":"225,91 257,91"},{"source":"QueryDate read?","target":"Get V1 date range","decision":"True","data":"373,91 442,91"},{"source":"QueryDate read?","target":"Log error msg","decision":"False","data":"320,126 320,303"},{"source":"Log error msg","target":"Stop","decision":"","data":"365,356 1662,596"},{"source":"Found new Actuals?","target":"Create V1 resource lookup table","decision":"True","data":"662.5,91 716.5,90"},{"source":"Actuals merged?","target":"Write to log","decision":"False","data":"1669,257 1591,358"},{"source":"Write to log","target":"Stop","decision":"","data":"1582,435 1667,558"},{"source":"Create V1 resource lookup table","target":"Read V1 Actuals","decision":"","data":"830.5,90 853,90"},{"source":"Actuals merged?","target":"Write to Clarity","decision":"True","data":"1695,257 1696,308"},{"source":"Found new Actuals?","target":"Log error","decision":"False","data":"625,126 625,217"},{"source":"Log error","target":"Stop","decision":"","data":"656,271 1662,591"},{"source":"Read V1 Actuals","target":"Create Clarity Tasks","decision":"","data":"965,90 989,90"},{"source":"Create Clarity Tasks","target":"Get internal Task IDs","decision":"","data":"1091,90 1113,90"},{"source":"Read Clarity TimePeriods","target":"Insert new Actuals","decision":"","data":"1350,90 1376,90"},{"source":"Output rowset","target":"Actuals merged?","decision":"","data":"1695,124 1695,177"},{"source":"Get internal Task IDs","target":"Read Clarity TimePeriods","decision":"","data":"1235,90 1256,90"},{"source":"Insert new Actuals","target":"Check for more Actuals?","decision":"","data":"1460,89 1490,87"},{"source":"Check for more Actuals?","target":"Increment counter","decision":"True","data":"1530,120 1502,167"},{"source":"Increment counter","target":"Insert new Actuals","decision":"","data":"1461,175 1442,134"},{"source":"Check for more Actuals?","target":"Output rowset","decision":"False","data":"1601,87 1641.5,89"},{"source":"Write to Clarity","target":"Update last run date","decision":"","data":"1696,387 1697,420"},{"source":"Update last run date","target":"Stop","decision":"","data":"1697,499 1696,557"}],"ui":{"dividerY":564,"paletteX":965.1,"paletteY":410.65},"maxThreads":1,"steps":[{"x":1633,"y":181,"description":"This decision step determines whether or not the incoming actuals were matched to the correct TimeSheet and should be inserted.  If none were matched, there is nothing to be written to Clarity.","expression":"actualsMerged == 1","enabled":true,"name":"Actuals merged?","type":"Decision","ignoreError":false},{"x":1489,"y":44,"description":"","expression":"LogMessage(\"info\", \"VersionOne_Actuals_rowset.Size: \" & VersionOne_Actuals_rowset.Size)\rLogMessage(\"info\", \"stopLoopFlag: \" & stopLoopFlag)\rLogMessage(\"info\", \"Not stopLoopFlag: \" & Not stopLoopFlag)\rLogMessage(\"info\", \"loopCounter: \" & loopCounter)\r\rReturn VersionOne_Actuals_rowset.Size > 0 And Not stopLoopFlag And loopCounter <= 10","enabled":true,"name":"Check for more Actuals?","type":"Decision","ignoreError":false},{"x":989,"y":49,"description":"","sessions":[],"process":"p_create_Clarity_tasks","enabled":true,"name":"Create Clarity Tasks","datasets":[],"type":"Process","ignoreError":false},{"x":716,"y":49,"description":"","sessions":[],"process":"p_reconcile_resources","enabled":true,"name":"Create V1 resource lookup table","datasets":[],"type":"Process","ignoreError":false},{"x":578,"y":50,"description":"Decision step will return True if any Actuals have been created/updated since the last time the integration ran.  If there are no new Actuals to be integrated, then the process is finished.","expression":"Len(Trim(MacroValue(\"MinActualDate\"))) > 0 And Len(Trim(MacroValue(\"MaxActualDate\"))) > 0","enabled":true,"name":"Found new Actuals?","type":"Decision","ignoreError":false},{"x":1113,"y":49,"description":"This process reads Tasks from Clarity PPM and grabs the internal Task IDs for the new Tasks that were just created.  This ID is necessary when logging the time in Clarity PPM.","sessions":[],"process":"p_get_internalTaskIDs","enabled":true,"name":"Get internal Task IDs","datasets":[],"type":"Process","ignoreError":false},{"x":442,"y":50,"description":"","sessions":[],"process":"p_GetDateRange_VersionOne","enabled":true,"name":"Get V1 date range","datasets":[],"type":"Process","ignoreError":false},{"x":1430,"y":169,"description":"","expression":"loopCounter = loopCounter + 1\rstopLoopFlag = True","enabled":true,"name":"Increment counter","type":"Script","script":"","ignoreError":false},{"targetDatasets":[{"name":"TARGET_1","dataset_rref":"m_insert_new_Actuals_trg_ds"}],"x":1376,"y":49,"sourceDatasets":[{"name":"SOURCE","dataset_rref":"m_insert_new_Actuals_src_ds"}],"map":"m_insert_new_Actuals","description":"","lookupDatasets":[],"enabled":true,"name":"Insert new Actuals","type":"Transformation","ignoreError":false},{"x":584,"y":221,"description":"","expression":"LogMessage(\"info\", \">>>>> No new actuals were found.\")","enabled":true,"name":"Log error","type":"Script","script":"","ignoreError":false},{"x":265,"y":307,"description":"","expression":"LogMessage(\"error\", \">>>>> ERROR: QueryDate not found.  Either the file does not exist, or the date was not written to the file correctly on the last execution.\")","enabled":true,"name":"Log error msg","type":"Script","script":"","ignoreError":false},{"x":1641,"y":48,"description":"","expression":"LogMessage(\"info\", \">>>>> The following Actuals were not able to be inserted.\")\rLogMessage(\"info\", \">>>>> The fields are as follows: Rowset contains: (1)Email, (2)Project reference, (3)Task reference, (4)Actual date, (5)Actual value, (6)Workitem.Number, (7)internalTaskID\")\r\rFor counter = 1 to VersionOne_Actuals_rowset.Size\r\tFor count2 = 1 to VersionOne_Actuals_rowset.FieldCount(counter)\r\t\tLogMessage(\"info\", \">>>>> Rowset (\" & counter & \", \" & count2 & \") :: \" & VersionOne_Actuals_rowset.Value(counter, count2))\r\tNext count2\rNext counter\r","enabled":true,"name":"Output rowset","type":"Script","script":"","ignoreError":false},{"x":257,"y":50,"description":"","expression":"MacroValue(\"QueryDate\") <> \"\"","enabled":true,"name":"QueryDate read?","type":"Decision","ignoreError":false},{"targetDatasets":[{"name":"TARGET_1","dataset_rref":"m_read_Clarity_TimePeriods_trg_ds"}],"x":1256,"y":49,"sourceDatasets":[{"name":"SOURCE","dataset_rref":"m_read_Clarity_TimePeriods_src_ds"}],"map":"m_read_Clarity_TimePeriods","description":"","lookupDatasets":[],"enabled":true,"name":"Read Clarity TimePeriods","type":"Transformation","ignoreError":false},{"x":111,"y":50,"description":"Grabs the value for the QueryDate macro from a local file.","expression":"filename = MacroValue(\"DATA\") & \"VersionOne_Clarity_lastRunDate.txt\"\r\rIf FileExists(filename) Then\r\ttemp = FileRead(filename)\r\tDefineMacro(\"QueryDate\", temp)\rElse\r\tDefineMacro(\"QueryDate\", \"\")\rEnd If\r\rLogMessage(\"info\", \">>>>> Incoming query date read from file: \" & MacroValue(\"QueryDate\"))","enabled":true,"name":"Read QueryDate","type":"Script","script":"","ignoreError":false},{"x":853,"y":49,"description":"","sessions":[],"process":"p_read_VersionOne_Actuals","enabled":true,"name":"Read V1 Actuals","datasets":[],"type":"Process","ignoreError":false},{"x":9,"y":50,"description":"","expression":"","enabled":true,"name":"Start","type":"Start","script":"","ignoreError":false},{"x":1661,"y":560,"description":"","expression":"ILClear(\"Clarity_resourceIDs\")\r\rSet VersionOne_Actuals_rowset = Nothing\rSet Clarity_Project_rowset = Nothing\r","enabled":true,"name":"Stop","type":"Stop","script":"","ignoreError":false},{"targetDatasets":[{"name":"TARGET_1","dataset_rref":"m_update_lastRunDate_trg_ds"}],"x":1636,"y":423,"sourceDatasets":[{"name":"SOURCE","dataset_rref":"m_update_lastRunDate_src_ds"}],"map":"m_update_lastRunDate","description":"","lookupDatasets":[],"enabled":true,"name":"Update last run date","type":"Transformation","ignoreError":false},{"targetDatasets":[{"name":"TARGET_1","dataset_rref":"m_write_TimePeriods_to_Clarity_trg_ds"}],"x":1639,"y":311,"sourceDatasets":[{"name":"SOURCE","dataset_rref":"m_write_TimePeriods_to_Clarity_src_ds"}],"map":"m_write_TimePeriods_to_Clarity","description":"","lookupDatasets":[],"enabled":true,"name":"Write to Clarity","type":"Transformation","ignoreError":false},{"x":1510,"y":359,"description":"","expression":"LogMessage(\"info\", \">>>>> Unable to map any incoming actuals to Clarity PPM TimeSheets.  Nothing will be written to Clarity PPM.\")","enabled":true,"name":"Write to log","type":"Script","script":"","ignoreError":false}],"variables":[{"description":"This is a flag to indicate whether or not the incoming actuals have been merged with the existing ones.  If none have been merged then there is nothing to write to Clarity PPM.","initialValue":"0","is_public":true,"array":false,"name":"actualsMerged","dims":[],"type":"Variant"},{"description":"","initialValue":"","is_public":true,"array":false,"name":"VersionOne_Actuals_rowset","dims":[],"type":"DJRowSet"},{"description":"","initialValue":"","is_public":false,"array":false,"name":"Clarity_Project_rowset","dims":[],"type":"DJRowSet"},{"description":"","initialValue":"True","is_public":true,"array":false,"name":"stopLoopFlag","dims":[],"type":"Variant"},{"description":"This variable keeps track of how many times the process has looped while inserting new Actuals.  If this counter reaches the (arbitrary) limit, then the loop will break, preventing an infinite loop from happening if something goes wrong.","initialValue":"0","is_public":false,"array":false,"name":"loopCounter","dims":[],"type":"Variant"}]}